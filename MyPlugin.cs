using System;
using System.Collections.Generic;
using System.ComponentModel.Composition;
using System.IO;
using System.Linq;
using System.Reflection;
using XrmToolBox.Extensibility;
using XrmToolBox.Extensibility.Interfaces;

namespace OS.CountEntityRecords
{
    // Do not forget to update version number and author (company attribute) in AssemblyInfo.cs class
    // To generate Base64 string for Images below, you can use https://www.base64-image.de/
    [Export(typeof(IXrmToolBoxPlugin)),
        ExportMetadata("Name", "Count Entity Records Plugin"),
        ExportMetadata("Description", "The Purpose of this plugin is to count the records of any entity"),
        // Please specify the base64 content of a 32x32 pixels image
        ExportMetadata("SmallImageBase64", "/9j/4AAQSkZJRgABAQIAHAAcAAD/4RPURXhpZgAASUkqAAgAAAAGABoBBQABAAAAVgAAABsBBQABAAAAXgAAACgBAwABAAAAAwAAADEBAgANAAAAZgAAADIBAgAUAAAAdAAAAGmHBAABAAAAiAAAAJoAAAA3AgAAFAAAADcCAAAUAAAAR0lNUCAyLjEwLjE4AAAyMDIyOjEwOjA3IDEzOjQyOjA5AAEAAaADAAEAAAABAAAAAAAAAAgAAAEEAAEAAADwAAAAAQEEAAEAAAAAAQAAAgEDAAMAAAAAAQAAAwEDAAEAAAAGAAAABgEDAAEAAAAGAAAAFQEDAAEAAAADAAAAAQIEAAEAAAAGAQAAAgIEAAEAAADGEgAAAAAAAAgACAAIAP/Y/+AAEEpGSUYAAQEAAAEAAQAA/9sAQwAIBgYHBgUIBwcHCQkICgwUDQwLCwwZEhMPFB0aHx4dGhwcICQuJyAiLCMcHCg3KSwwMTQ0NB8nOT04MjwuMzQy/9sAQwEJCQkMCwwYDQ0YMiEcITIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIy/8AAEQgBAADwAwEiAAIRAQMRAf/EAB8AAAEFAQEBAQEBAAAAAAAAAAABAgMEBQYHCAkKC//EALUQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+v/EAB8BAAMBAQEBAQEBAQEAAAAAAAABAgMEBQYHCAkKC//EALURAAIBAgQEAwQHBQQEAAECdwABAgMRBAUhMQYSQVEHYXETIjKBCBRCkaGxwQkjM1LwFWJy0QoWJDThJfEXGBkaJicoKSo1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoKDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uLj5OXm5+jp6vLz9PX29/j5+v/aAAwDAQACEQMRAD8A9/ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACimSypBGZJG2qoyTjNcZq/xY8G6LK0N3q22YMybPs0x5U4PIQigDtqK8Zvf2iNEgJ+y2P2kYOD5zpnj3jrJm/aXRWxH4V3gj739oYwf+/VAHvlFeCQ/tLRMD5vhfy8Yx/wATAnP/AJCresf2gvDc+37XH9lyQD80j4GevEdAHrtFcdpHxT8Ha5KsNhq/mzHHyfZplweBjJQDqRXXxussayIcqwDA+oNADqKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKhuru2srd57q4ighjUu8krhVVQMkknoAK8N+IPx4NncTad4XEE4w0b3MnzL1ZS0bRyeykHHvQB6r4n8Z6P4bsXlub6xM4OFt5LtI2chgCBnnjOTxXz3r/x88TanJINM/4lkDqVMX7ubqAOrR59T+NebatrWo63dvc6jeT3Ds7SASSs4QscnbuJwOn5VQoAt6jqd3q1493fTebO5JZ9oXOSSeAAOpNVKKKACiiigAooooAK0dH13UtAuvtWmXPkTf3tit2I6MCOhNZ1FAHuPhr9obU4TBa6zp63zySKrXTXCQhAWOSQseOAR37V7v4f8R6b4jsI7mwvbSZmUF44LhZTGcAlTjuMivhetrw94r1nwveR3Gl308SpIJGhEzrHIQQcMqkZB2gH2oA+5aK8e8CfHLTtblWy194LCbYgE7lYotwVi2WeQnGQAPrXsCsrqGVgynuDmgBaKKKACiiigAooooAKKKKAGh1JxmnVDGu45z0qagAooooAKhurqGytnuLh9kSY3NgnGTjt9afNNHbwSTSusccal3dzgKAMkk9hXyx8WPije+Jry70C2RYdPtbmaF3SRZRdKsg2MDtBUfJngnOaAIPih8U5/Fmoi30i4u7XTo1ZH8q5cJcK6oCGTC8DDDBznJrzGiigAooooAKKKKACiiigAooooAKKKKACiiigAr3z4U/GGG2s7fQ9fmuJLhpUiiup55JW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"),
        // Please specify the base64 content of a 80x80 pixels image
        ExportMetadata("BigImageBase64", "/9j/4AAQSkZJRgABAQIAHAAcAAD/4RPURXhpZgAASUkqAAgAAAAGABoBBQABAAAAVgAAABsBBQABAAAAXgAAACgBAwABAAAAAwAAADEBAgANAAAAZgAAADIBAgAUAAAAdAAAAGmHBAABAAAAiAAAAJoAAAA3AgAAFAAAADcCAAAUAAAAR0lNUCAyLjEwLjE4AAAyMDIyOjEwOjA3IDEzOjQyOjA5AAEAAaADAAEAAAABAAAAAAAAAAgAAAEEAAEAAADwAAAAAQEEAAEAAAAAAQAAAgEDAAMAAAAAAQAAAwEDAAEAAAAGAAAABgEDAAEAAAAGAAAAFQEDAAEAAAADAAAAAQIEAAEAAAAGAQAAAgIEAAEAAADGEgAAAAAAAAgACAAIAP/Y/+AAEEpGSUYAAQEAAAEAAQAA/9sAQwAIBgYHBgUIBwcHCQkICgwUDQwLCwwZEhMPFB0aHx4dGhwcICQuJyAiLCMcHCg3KSwwMTQ0NB8nOT04MjwuMzQy/9sAQwEJCQkMCwwYDQ0YMiEcITIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIy/8AAEQgBAADwAwEiAAIRAQMRAf/EAB8AAAEFAQEBAQEBAAAAAAAAAAABAgMEBQYHCAkKC//EALUQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+v/EAB8BAAMBAQEBAQEBAQEAAAAAAAABAgMEBQYHCAkKC//EALURAAIBAgQEAwQHBQQEAAECdwABAgMRBAUhMQYSQVEHYXETIjKBCBRCkaGxwQkjM1LwFWJy0QoWJDThJfEXGBkaJicoKSo1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoKDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uLj5OXm5+jp6vLz9PX29/j5+v/aAAwDAQACEQMRAD8A9/ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACimSypBGZJG2qoyTjNcZq/xY8G6LK0N3q22YMybPs0x5U4PIQigDtqK8Zvf2iNEgJ+y2P2kYOD5zpnj3jrJm/aXRWxH4V3gj739oYwf+/VAHvlFeCQ/tLRMD5vhfy8Yx/wATAnP/AJCresf2gvDc+37XH9lyQD80j4GevEdAHrtFcdpHxT8Ha5KsNhq/mzHHyfZplweBjJQDqRXXxussayIcqwDA+oNADqKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKhuru2srd57q4ighjUu8krhVVQMkknoAK8N+IPx4NncTad4XEE4w0b3MnzL1ZS0bRyeykHHvQB6r4n8Z6P4bsXlub6xM4OFt5LtI2chgCBnnjOTxXz3r/x88TanJINM/4lkDqVMX7ubqAOrR59T+NebatrWo63dvc6jeT3Ds7SASSs4QscnbuJwOn5VQoAt6jqd3q1493fTebO5JZ9oXOSSeAAOpNVKKKACiiigAooooAK0dH13UtAuvtWmXPkTf3tit2I6MCOhNZ1FAHuPhr9obU4TBa6zp63zySKrXTXCQhAWOSQseOAR37V7v4f8R6b4jsI7mwvbSZmUF44LhZTGcAlTjuMivhetrw94r1nwveR3Gl308SpIJGhEzrHIQQcMqkZB2gH2oA+5aK8e8CfHLTtblWy194LCbYgE7lYotwVi2WeQnGQAPrXsCsrqGVgynuDmgBaKKKACiiigAooooAKKKKAGh1JxmnVDGu45z0qagAooooAKhurqGytnuLh9kSY3NgnGTjt9afNNHbwSTSusccal3dzgKAMkk9hXyx8WPije+Jry70C2RYdPtbmaF3SRZRdKsg2MDtBUfJngnOaAIPih8U5/Fmoi30i4u7XTo1ZH8q5cJcK6oCGTC8DDDBznJrzGiigAooooAKKKKACiiigAooooAKKKKACiiigAr3z4U/GGG2s7fQ9fmuJLhpUiiup55JW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"),
        ExportMetadata("BackgroundColor", "Lavender"),
        ExportMetadata("PrimaryFontColor", "Black"),
        ExportMetadata("SecondaryFontColor", "Gray")]
    public class MyPlugin : PluginBase
    {
        public override IXrmToolBoxPluginControl GetControl()
        {
            return new CountControl();
        }

        /// <summary>
        /// Constructor 
        /// </summary>
        public MyPlugin()
        {
            // If you have external assemblies that you need to load, uncomment the following to 
            // hook into the event that will fire when an Assembly fails to resolve
            // AppDomain.CurrentDomain.AssemblyResolve += new ResolveEventHandler(AssemblyResolveEventHandler);
        }

        /// <summary>
        /// Event fired by CLR when an assembly reference fails to load
        /// Assumes that related assemblies will be loaded from a subfolder named the same as the Plugin
        /// For example, a folder named Sample.XrmToolBox.MyPlugin 
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="args"></param>
        /// <returns></returns>
        private Assembly AssemblyResolveEventHandler(object sender, ResolveEventArgs args)
        {
            Assembly loadAssembly = null;
            Assembly currAssembly = Assembly.GetExecutingAssembly();

            // base name of the assembly that failed to resolve
            var argName = args.Name.Substring(0, args.Name.IndexOf(","));

            // check to see if the failing assembly is one that we reference.
            List<AssemblyName> refAssemblies = currAssembly.GetReferencedAssemblies().ToList();
            var refAssembly = refAssemblies.Where(a => a.Name == argName).FirstOrDefault();

            // if the current unresolved assembly is referenced by our plugin, attempt to load
            if (refAssembly != null)
            {
                // load from the path to this plugin assembly, not host executable
                string dir = Path.GetDirectoryName(currAssembly.Location).ToLower();
                string folder = Path.GetFileNameWithoutExtension(currAssembly.Location);
                dir = Path.Combine(dir, folder);

                var assmbPath = Path.Combine(dir, $"{argName}.dll");

                if (File.Exists(assmbPath))
                {
                    loadAssembly = Assembly.LoadFrom(assmbPath);
                }
                else
                {
                    throw new FileNotFoundException($"Unable to locate dependency: {assmbPath}");
                }
            }

            return loadAssembly;
        }
    }
}